{"version":3,"sources":["../src/polyfiller.js"],"names":["browser","Bowser","getParser","window","navigator","userAgent","platform","getPlatformType","name","getBrowserName","capabilities","touch","os","getOSName","engine","getEngineName","version","getBrowserVersion","split","resolveCapabilities","document","body","classList","add","webp","Image","onload","onerror","height","push","src","root","polyfills","_polyfills","map","files","p","satisfies","i","length","j","script","createElement","appendChild","console","log"],"mappings":"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","file":"polyfiller.js","sourcesContent":["import 'jspolyfill-array.prototype.find' // needed for bowser support\r\nimport Bowser from 'bowser'\r\n\r\n// resolve browser features\r\nexport const browser = Bowser.getParser(window.navigator.userAgent)\r\n\r\nconst platform = browser.getPlatformType(true)\r\nlet name = browser.getBrowserName(true)\r\nif(name === 'internet explorer') name = 'ie'\r\n\r\nexport const capabilities = {\r\n  touch: (platform === 'mobile' || platform === 'tablet'),\r\n  platform: platform,\r\n  os: browser.getOSName(true),\r\n  engine: browser.getEngineName(true),\r\n  name: name,\r\n  version: `${name}${browser.getBrowserVersion().split('.')[0]}`\r\n}\r\n\r\n\r\n/**\r\n * Adds classes based on the user's environment on\r\n * the <body> element. This makes it possible to be\r\n * able to manage some particular case in css.\r\n */\r\nfunction resolveCapabilities() {\r\n\r\n  // returns capabilities (javascript)\r\n  window.capabilities = [\r\n    capabilities.touch ? 'touch-based' : 'not-touch-based',\r\n    capabilities.platform,\r\n    capabilities.os,\r\n    capabilities.engine,\r\n    capabilities.name,\r\n    capabilities.version\r\n  ]\r\n\r\n  // returns capabilities (css)\r\n  document.body.classList.add(capabilities.touch ? '-touch-based' : '-not-touch-based')\r\n  document.body.classList.add(`-${capabilities.platform}`)\r\n  document.body.classList.add(`-${capabilities.os}`)\r\n  document.body.classList.add(`-${capabilities.engine}`)\r\n  document.body.classList.add(`-${capabilities.name}`)\r\n  document.body.classList.add(`-${capabilities.version}`)\r\n\r\n  // webp support\r\n  const webp = new Image()\r\n  webp.onload = webp.onerror = () => {\r\n    if (webp.height === 2) {\r\n      window.capabilities.push('webp')\r\n      document.body.classList.add(`-webp`)\r\n    }\r\n  }\r\n  webp.src = 'data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoCAAIAAQAcJaQAA3AA/v3AgAA='\r\n}\r\n\r\n\r\n/**\r\n * Load polyfill as seperate files\r\n * @param {String} root path\r\n * @param {Array} polyfills\r\n */\r\nexport default (root, polyfills = []) => {\r\n\r\n  resolveCapabilities()\r\n\r\n  const _polyfills = polyfills.map(p => ({\r\n    files: p.files,\r\n    satisfies: browser.satisfies(p.satisfies)\r\n  }))\r\n\r\n  // add polyfills script in document\r\n  for (let i = 0; i < _polyfills.length; i += 1) {\r\n    if (_polyfills[i].satisfies) {\r\n      for(let j = 0; j < _polyfills[i].files.length; j++) {\r\n        const script = document.createElement('script')\r\n        script.src = `${root}${_polyfills[i].files[j]}.js`\r\n        document.body.appendChild(script)\r\n        console.log('load polyfill:', _polyfills[i].files[j])\r\n      }\r\n    }\r\n  }\r\n\r\n}"]}